<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ユメミる草原 - ラジオ体操参加</title>
<style>
:root{
  --bg:#f6f8fa;
  --card:#ffffff;
  --accent:#334155;
  --pink:#f7ddea;
  --blue:#d7e8f9;
  --line:#ffffffaa;
}
html,body{
  height:100%;margin:0;
  font-family:system-ui,-apple-system,"Hiragino Kaku Gothic ProN",Meiryo,sans-serif;
  background:url('https://raw.githubusercontent.com/yumemiru28000/yumemirusougenn/main/home.png') center/cover no-repeat;
  color:var(--accent);
}
/* ページ切り替え */
.page{display:none;width:100vw;height:100vh;}
.page.active{display:flex;align-items:center;justify-content:center;}

.wrap{min-height:100%;display:flex;align-items:center;justify-content:center;padding:32px}
.card{
  background:rgba(255,255,255,0.35);
  padding:28px;border-radius:20px;
  backdrop-filter:blur(7px);
  box-shadow:0 6px 20px rgba(16,24,40,0.12);
  width:100%;max-width:720px;text-align:center;
  border:2px solid #fff8;
}

h1{font-weight:700;margin:0 0 10px;font-size:36px;letter-spacing:0.02em;color:#4c6fae;}
p.subtitle{margin:0 0 18px;color:#475569}
.desc{margin:8px 0 12px;color:#334155}

/* 運営パス部 */
.admin-pass{
  margin-top:10px;
  display:flex;
  justify-content:center;
  gap:10px;
}

input[type=password]{padding:8px 10px;border-radius:8px;border:1px solid #dde4ee}
button{background:#ff9ad4;color:#fff;border:0;padding:12px 18px;border-radius:10px;font-size:16px;cursor:pointer}
button:disabled{opacity:0.45;cursor:not-allowed}
.small{font-size:12px;color:#64748b;margin-top:12px}

#remainingTime{font-size:18px;color:#ff4d4f;margin-bottom:10px;font-weight:600;}

/* 残り時間バー */
.timebar{
  width:80%;
  height:10px;
  background:#ffffff44;
  margin:8px auto 18px;
  border-radius:10px;
  overflow:hidden;
  border:1px solid #fff8;
}
.timebar-inner{
  height:100%;
  background:#ffd1ec;
  width:0%;
  transition:0.2s linear;
}

/* 動画再生 */
#playerContainer{
  position:fixed;inset:0;display:none;
  align-items:center;justify-content:center;
  background:#000;z-index:9999
}
video{width:100%;height:100%;object-fit:contain;background:black}

/* 図鑑・遊び方 */
.fullimage{width:100%;height:100%;object-fit:contain;background:black;}
.home-btn{
  position:absolute;bottom:20px;right:20px;
  padding:12px 20px;background:#ff9ad4;color:white;
  border-radius:10px;font-size:18px;
}
</style>
</head>
<body>

<!-- ホーム -->
<div id="home" class="page active">
  <div class="wrap">
    <div class="card">
      <h1>ユメの草原</h1>

      <button onclick="showPage('zukan')">図鑑</button>
      <button onclick="showPage('howto')">遊び方</button>

      <p class="subtitle">ラジオ体操開始時間: 毎朝6:00〜6:03 のみ参加可能</p>
      <p class="desc">開始可能時間の状態でのみボタンを押せます。<br>運営パスワード入力でいつでも参加可能になります。</p>

      <div id="remainingTime"></div>

      <div class="timebar"><div class="timebar-inner" id="timeBarInner"></div></div>

      <div class="controls">
        <button id="joinBtn" disabled>ラジオ体操参加</button>
      </div>

      <div class="admin-pass">
        <input id="pw" type="password" placeholder="運営パス (1122)">
      </div>

      <div class="small">※開始すると動画が全画面で再生されます。</div>
    </div>
  </div>
</div>

<!-- 図鑑ページ -->
<div id="zukan" class="page">
  <img src="https://raw.githubusercontent.com/yumemiru28000/yumemirusougenn/main/aaaa.jpg" class="fullimage">
  <button class="home-btn" onclick="showPage('home')">ホーム</button>
</div>

<!-- 遊び方ページ -->
<div id="howto" class="page">
  <img src="https://raw.githubusercontent.com/yumemiru28000/yumemirusougenn/main/イラスト11.jpg" class="fullimage">
  <button class="home-btn" onclick="showPage('home')">ホーム</button>
</div>

<!-- 動画再生 -->
<div id="playerContainer"></div>

<script>
/* ページ切り替え */
function showPage(id){
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

/* 設定 */
const config={
  videos:[
    {url:'https://raw.githubusercontent.com/yumemiru28000/yumemirusougenn/main/1o.mp4',weight:16},
    {url:'https://raw.githubusercontent.com/yumemiru28000/yumemirusougenn/main/1x.mp4',weight:2},
  ],
  bypassPassword:'1122',
  allowedTimes:[{hour:6,startMinute:0,endMinute:3}]
};

function nowJST(){
  const d=new Date();
  return new Date(d.getTime()+d.getTimezoneOffset()*60000+9*3600*1000);
}

function weightedPick(list){
  const total=list.reduce((s,i)=>s+(i.weight||1),0);
  let r=Math.random()*total;
  for(const item of list){
    r-=(item.weight||1);
    if(r<=0) return item;
  }
  return list[list.length-1];
}

const joinBtn=document.getElementById('joinBtn');
const pwInput=document.getElementById('pw');
const remainingTimeDiv=document.getElementById('remainingTime');
const timeBarInner=document.getElementById('timeBarInner');

function isWithinAllowedWindow(){
  const j=nowJST();
  for(const t of config.allowedTimes){
    const start=new Date(j);start.setHours(t.hour,t.startMinute,0,0);
    const end=new Date(j);end.setHours(t.hour,t.endMinute,59,999);
    if(j>=start && j<=end) return true;
  }
  return false;
}

function getNextWindow(){
  const j=nowJST();
  const t=config.allowedTimes[0];
  let nextStart=new Date(j);
  nextStart.setHours(t.hour,t.startMinute,0,0);
  if(nextStart<=j){ nextStart=new Date(nextStart.getTime()+24*3600*1000); }
  return nextStart;
}

/* UI更新 */
function updateUI(){
  const j=nowJST();
  const pwOk=pwInput.value===config.bypassPassword;
  const allowed=isWithinAllowedWindow()||pwOk;

  joinBtn.disabled=!allowed;
  joinBtn.textContent=pwOk?"ラジオ体操参加（解除中）":"ラジオ体操参加";

  const t=config.allowedTimes[0];
  const start=new Date(j); start.setHours(t.hour,t.startMinute,0,0);
  const end=new Date(j);   end.setHours(t.hour,t.endMinute,59,999);
  const total=end-start;

  if(j<start){
    const diff=start-j;
    const h=Math.floor(diff/3600000);
    const m=Math.floor((diff%3600000)/60000);
    const s=Math.floor((diff%60000)/1000);
    remainingTimeDiv.textContent=`開始可能時間 まで: ${h}時間 ${m}分 ${s}秒`;
    timeBarInner.style.width="0%";
  }
  else if(j>=start && j<=end){
    const diff=end-j;
    const m=Math.floor(diff/60000);
    const s=Math.floor((diff%60000)/1000);
    remainingTimeDiv.textContent=`開始可能時間 残り: ${m}分 ${s}秒`;
    const prog=((j-start)/total)*100;
    timeBarInner.style.width=prog+"%";
  }
  else{
    const next=getNextWindow();
    const diff=next-j;
    const h=Math.floor(diff/3600000);
    const m=Math.floor((diff%3600000)/60000);
    const s=Math.floor((diff%60000)/1000);
    remainingTimeDiv.textContent=`開始可能時間 まで: ${h}時間 ${m}分 ${s}秒`;
    timeBarInner.style.width="0%";
  }
}

/* 動画開始 */
async function onJoin(){
  const pick=weightedPick(config.videos);
  const container=document.getElementById('playerContainer');
  container.style.display='flex';
  container.innerHTML='';

  const vid=document.createElement('video');
  vid.src=pick.url;
  vid.playsInline=true;
  vid.autoplay=true;
  vid.controls=false;

  container.appendChild(vid);

  vid.addEventListener('loadeddata',async()=>{
    try{await vid.play();}catch(e){}
    try{if(container.requestFullscreen) await container.requestFullscreen({navigationUI:'hide'});}catch(e){}
  });

  vid.addEventListener('ended',async()=>{
    try{if(document.fullscreenElement) await document.exitFullscreen();}catch(e){}

    vid.remove();
    const endText=document.createElement('div');
    endText.textContent='END';
    Object.assign(endText.style,{
      color:'#fff',fontSize:'48px',fontWeight:'700',position:'absolute',top:'45%',left:'50%',transform:'translate(-50%,-50%)'
    });
    container.appendChild(endText);
  });
}

/* 初期化 */
(function init(){
  updateUI();
  setInterval(updateUI,1000);
  joinBtn.addEventListener('click',onJoin);
})();
</script>

</body>
</html>
<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ユメミる草原 - ラジオ体操参加</title>
<style>
:root{
  --bg:#f6f8fa;
  --card:#ffffff;
  --accent:#334155;
  --yume-pink:#f7d9ec;
  --yume-blue:#cbe4ff;
  --yume-white:#ffffff;
  --bar-bg:#ffffff55;
  --bar-fill:#ffffff;
}
html,body{
  height:100%;margin:0;
  font-family:system-ui,-apple-system,"Hiragino Kaku Gothic ProN",Meiryo,sans-serif;
  background:url('https://raw.githubusercontent.com/yumemiru28000/yumemirusougenn/main/home.png') center/cover no-repeat;
  color:var(--accent);
}

/* ページ切替 */
.page{display:none;width:100vw;height:100vh;}
.page.active{display:flex;align-items:center;justify-content:center;}

/* カード（ゆめかわUI化） */
.card{
  background:rgba(255,255,255,0.35);
  backdrop-filter:blur(6px);
  padding:28px;
  border-radius:18px;
  box-shadow:0 6px 20px rgba(16,24,40,0.12);
  width:100%;max-width:720px;
  text-align:center;
  border:3px solid var(--yume-blue);
}

h1{
  font-weight:700;
  margin:0 0 10px;
  font-size:38px;
  letter-spacing:0.02em;
  color:#5aa7ff;
  text-shadow:0 0 6px #ffffffaa;
}

p.subtitle{margin:0 0 18px;color:#475569;font-weight:600;}
.desc{margin:8px 0 22px;color:#334155;}

button{
  background:var(--yume-pink);
  color:#4a4a4a;
  border:0;
  padding:12px 22px;
  border-radius:14px;
  font-size:17px;
  cursor:pointer;
  box-shadow:0 3px 6px #00000025;
  font-weight:600;
}
button:hover{
  background:#ffe6f4;
}
button:disabled{
  opacity:0.45;
  cursor:not-allowed;
}

/* パスワード入力 */
input[type=password]{
  padding:8px 10px;
  border-radius:10px;
  border:2px solid var(--yume-blue);
  background:#ffffffaa;
  backdrop-filter:blur(4px);
}

/* ゆめかわ風バー（残り時間） */
.time-bar-wrap{
  width:100%;
  height:16px;
  background:var(--bar-bg);
  border-radius:20px;
  margin-top:6px;
  margin-bottom:14px;
  overflow:hidden;
  border:2px solid #fff;
}
.time-bar{
  height:100%;
  width:0%;
  background:var(--bar-fill);
  transition:width 0.2s linear;
}

#remainingTime{
  font-size:17px;
  font-weight:700;
  margin-bottom:4px;
  color:#ffffff;
  text-shadow:0 0 4px #0008;
}

/* 図鑑・遊び方 */
.fullimage{
  width:100%;height:100%;object-fit:contain;background:black;
}
.home-btn{
  position:absolute;bottom:20px;right:20px;
  padding:12px 20px;background:#f7d9ec;color:#333;
  border-radius:12px;font-size:18px;font-weight:700;
  box-shadow:0 3px 6px #0005;
}

/* 動画 */
#playerContainer{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:#000;z-index:9999}
video{width:100%;height:100%;object-fit:contain;background:black}
</style>
</head>
<body>

<!-- ▼ ホーム画面 -->
<div id="home" class="page active">
  <div class="wrap">
    <div class="card">

      <h1>ユメの草原</h1>

      <!-- 図鑑 / 遊び方ボタン -->
      <button onclick="showPage('zukan')">図鑑</button>
      <button onclick="showPage('howto')">遊び方</button>
      <br><br>

      <p class="subtitle">開始可能時間 : 日本時間 <strong>06:00〜06:03</strong></p>
      <p class="desc">この時間帯のみ参加できます。運営用パスワードを入れるといつでも参加可能です。</p>

      <!-- 残り時間表示 -->
      <div id="remainingTime"></div>
      <div class="time-bar-wrap"><div id="timeBar" class="time-bar"></div></div>

      <!-- パス入力 -->
      <input id="pw" type="password" placeholder="運営用パスワード (1122)"><br><br>

      <button id="joinBtn" disabled>ラジオ体操参加</button>

    </div>
  </div>
</div>

<!-- ▼ 図鑑 -->
<div id="zukan" class="page">
  <img src="https://raw.githubusercontent.com/yumemiru28000/yumemirusougenn/main/aaaa.jpg" class="fullimage">
  <button class="home-btn" onclick="showPage('home')">ホーム</button>
</div>

<!-- ▼ 遊び方 -->
<div id="howto" class="page">
  <img src="https://raw.githubusercontent.com/yumemiru28000/yumemirusougenn/main/イラスト11.png" class="fullimage">
  <button class="home-btn" onclick="showPage('home')">ホーム</button>
</div>

<!-- ▼ 動画再生領域 -->
<div id="playerContainer"></div>

<script>
/* ページ切替 */
function showPage(id){
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

/* ▼ 設定 */
const config={videos:[
  {id:'v1',url:'https://raw.githubusercontent.com/yumemiru28000/yumemirusougenn/main/1o.mp4',weight:16},
  {id:'v2',url:'https://raw.githubusercontent.com/yumemiru28000/yumemirusougenn/main/1x.mp4',weight:2},
  {id:'v3',url:'https://raw.githubusercontent.com/yumemiru28000/yumemirusougenn/main/2o.mp4',weight:16},
  {id:'v4',url:'https://raw.githubusercontent.com/yumemiru28000/yumemirusougenn/main/2x.mp4',weight:1},
  {id:'v5',url:'https://raw.githubusercontent.com/yumemiru28000/yumemirusougenn/main/3o.mp4',weight:16},
  {id:'v6',url:'https://raw.githubusercontent.com/yumemiru28000/yumemirusougenn/main/3x.mp4',weight:1},
  {id:'v7',url:'https://raw.githubusercontent.com/yumemiru28000/yumemirusougenn/main/4o.mp4',weight:10},
  {id:'v8',url:'https://raw.githubusercontent.com/yumemiru28000/yumemirusougenn/main/4x.mp4',weight:1},
  {id:'v9',url:'https://raw.githubusercontent.com/yumemiru28000/yumemirusougenn/main/5o.mp4',weight:10},
  {id:'v10',url:'https://raw.githubusercontent.com/yumemiru28000/yumemirusougenn/main/5x.mp4',weight:1},
  {id:'v11',url:'https://raw.githubusercontent.com/yumemiru28000/yumemirusougenn/main/6o.mp4',weight:10},
  {id:'v12',url:'https://raw.githubusercontent.com/yumemiru28000/yumemirusougenn/main/6x.mp4',weight:1},
  {id:'v13',url:'https://raw.githubusercontent.com/yumemiru28000/yumemirusougenn/main/7x.mp4',weight:11},
  {id:'v14',url:'https://raw.githubusercontent.com/yumemiru28000/yumemirusougenn/main/8x.mp4',weight:2},
  {id:'v15',url:'https://raw.githubusercontent.com/yumemiru28000/yumemirusougenn/main/9x.mp4',weight:2},
],
  bypassPassword:'1122',
  allowedTimes:[{hour:6,startMinute:0,endMinute:3}]
};

function nowJST(){const d=new Date();return new Date(d.getTime()+d.getTimezoneOffset()*60000+9*3600*1000);} 

function isWithinAllowedWindow(){
  const j=nowJST();
  for(const t of config.allowedTimes){
    const s=new Date(j); s.setHours(t.hour,t.startMinute,0,0);
    const e=new Date(j); e.setHours(t.hour,t.endMinute,59,999);
    if(j>=s && j<=e) return true;
  }
  return false;
}

function getNextStart(){
  const j=nowJST();
  let next=null;
  for(const t of config.allowedTimes){
    const s=new Date(j); s.setHours(t.hour,t.startMinute,0,0);
    if(s>j && (!next||s<next)) next=s;
  }
  if(!next){
    const t=config.allowedTimes[0];
    next=new Date(j.getTime()+24*3600*1000);
    next.setHours(t.hour,t.startMinute,0,0);
  }
  return next;
}

function updateRemaining(){
  const j=nowJST();
  const pw=document.getElementById('pw').value===config.bypassPassword;
  const joinBtn=document.getElementById('joinBtn');
  const tDiv=document.getElementById('remainingTime');
  const bar=document.getElementById('timeBar');

  const allowed=isWithinAllowedWindow()||pw;
  joinBtn.disabled=!allowed;

  if(pw){
    tDiv.textContent='運営モード - いつでも開始できます';
    bar.style.width='100%';
    return;
  }

  if(isWithinAllowedWindow()){
    const t=config.allowedTimes[0];
    const end=new Date(j); end.setHours(t.hour,t.endMinute,0,0);
    const diff=(end-j)/1000;
    const min=Math.floor(diff/60);
    const sec=Math.floor(diff%60);

    tDiv.textContent=`開始可能時間内 : 残り ${min}分 ${sec}秒`;

    const total=(t.endMinute*60)-(t.startMinute*60);
    const pass=(j.getMinutes()*60+j.getSeconds())-(t.startMinute*60);
    bar.style.width=`${(pass/total)*100}%`;
  }else{
    const next=getNextStart();
    const diff=(next-j)/1000;
    const h=Math.floor(diff/3600);
    const m=Math.floor((diff%3600)/60);
    const s=Math.floor(diff%60);

    tDiv.textContent=`次の開始可能時間まで: ${h}時間 ${m}分 ${s}秒`;
    bar.style.width='0%';
  }
}
setInterval(updateRemaining,1000);
updateRemaining();
</script>

</body>
</html>

